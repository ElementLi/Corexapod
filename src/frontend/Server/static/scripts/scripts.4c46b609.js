"use strict";angular.module("corexapodControllerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("corexapodControllerApp").controller("MainCtrl",["$scope","$http",function(a,b){jQuery("li.active").removeClass("active"),jQuery('a[ng-href="#"]').parent("li").addClass("active"),jQuery("table a").click(function(){var a=jQuery(this).attr("href");if(("/act/reboot"==a||"/act/poweroff"==a)&&!c){var d=confirm("确认关机或重启？");if(1!=d)return!1}return jQuery("table#left a").addClass("disabled"),jQuery("#info").addClass("alert-warning").text("用户指令执行中"),b.get(a).success(function(){if(jQuery("#info").removeClass("alert-warning").removeClass("alert-danger").text("等待用户指令"),"/act/autoenable"==a)console.log(this),jQuery('a[href="/act/autoenable"]').attr("href","/act/autodisable").html('<span class="glyphicon glyphicon-stop"></span>').removeClass("disabled");else if("/act/poweroff"==a){clearInterval(f),jQuery("#info").addClass("alert-info").html('<span id="countdown">90</span> 秒后可以安全关闭电源');var b=window.setInterval(function(){var a=jQuery("#countdown").text();0==a&&(jQuery("#info").text("现在可以安全关闭电源"),window.clearInterval(b)),jQuery("#countdown").text(a-1)},1e3)}else"/act/autodisable"==a&&jQuery('a[href="/act/autodisable"]').attr("href","/act/autoenable").html('<span class="glyphicon glyphicon-play"></span>'),jQuery("table#left a").removeClass("disabled")}).error(function(){jQuery("#info").removeClass("alert-warning").addClass("alert-danger").text("连接丢失或机器人无响应"),jQuery("table#left a").removeClass("disabled")}),!1});var c=!1,d=!1,e=function(){b.get("/act/status").success(function(b){jQuery("#info").removeClass("alert-warning").removeClass("alert-danger").text("等待用户指令"),a.battery=b.battery,jQuery(".progress-bar").css("width",b.battery);var e=parseInt(b.battery.replace("%",""));18>=e&&(d||(alert("电量不足"),jQuery(".progress-bar").addClass("progress-bar-danger"),d=!0),8>=e?(c=!0,jQuery('a[href="/act/poweroff"]').click()):jQuery("#info").addClass("alert-danger").text("电量不足")),a.totalUseTime=b.totalUseTime,a.powerCycle=b.powerCycle}).error(function(){jQuery("#info").removeClass("alert-warning").addClass("alert-danger").text("连接丢失或机器人无响应")})},f=window.setInterval(e,6e4);e()}]),angular.module("corexapodControllerApp").controller("AboutCtrl",["$scope",function(){jQuery("li.active").removeClass("active"),jQuery('a[ng-href="#/about"]').parent("li").addClass("active")}]);